<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Array</title>
</head>

<body>
  <h1>forEach的用法學習</h1>
  <ul>
    <li>1</li>
    <li>2</li>
    <li>3</li>
  </ul>
  <script>
    var arr = [{
      a: 1,
      b: 2,
      c: 3
    }, {
      a: 21,
      b: 22,
      c: 23
    }, {
      a: 31,
      b: 32,
      c: 33
    }]
    arr.forEach(function (item, index, array) {
      'use strict'
      console.log('item：', item, 'index：', index, 'array：', array)
      console.log('this', this)
    }, document.getElementsByTagName('li'))
    console.log()
    /* 解锁新姿势 */
    arr.forEach(function (item, index, array) {
      this[index].innerText = JSON.stringify(item);
    }, document.getElementsByTagName('li'))
    /* 仿写 */
    /* 
    思路：
    1、传递一个函数参数
    2、可以接受第二个参数，作为this指向
    函数执行次数等于数组长度
    */
    Array.prototype.gjfForEach = function (fn) {
      var _arr = this,
        len = this.length,
        params02 = arguments[1] || window; //this函数执行时的指向（严格模式指向undefined怎么办？）
      for (let i = 0; i < len; i++) {
        fn.apply(params02, [_arr[i], i, _arr]);
      }
      return 'author:@guojufeng';
    }
    arr.gjfForEach(function (el, i, arr) {
      console.log(this, el, i, arr)
    }, document.getElementsByTagName('li'));
    arr.gjfForEach(function (el, i, arr) {
      console.log(this, el, i, arr)
    });
    arr.gjfForEach(function (el, i, arr) {
      console.log(this, el, i, arr)
    }, 'str');
    arr.forEach(function (el, i, arr) {
      console.log(this, el, i, arr)
    }, 'str');
  </script>
  <h1>filter - 过滤</h1>
  <script>
    var newArr = arr.filter(function (el, i, arr) {
      console.log(el, i, arr)
      console.log(this, el.b)
      /* if(el.b > 20){
        return true;
      }else{
        return false;
      } */
      // 简化写法
      return el.b > 20
    }, 'str');
    var newArr = arr.filter(function (el, i, arr) {
      return true
    });
    console.log(newArr);
    // newArr[1].b = 'gjf';
    // console.log(arr, newArr)
    /* 重写 */
    /* 
      思路基本同forEach，但是多一条是要有返回值
      遍历执行次数等于数组的长度
      第一个必填fun，fun有三个参数分别是el项、index值、arr自身
      第二个选填，指向fun中的this
      同forEach比，特殊点，最后返回一个数组，数组中放条件成立的项
    */
   console.log('======仿写=========')
    Array.prototype.gjfFilter = function (fn) {
      var _arr = this,
        len = this.length,
        self = arguments[1] || window,
        resultArr = [];
      for (let i = 0; i < len; i++) {
        fn.apply(self, [_arr[i], i, _arr]) ? resultArr.push(_arr[i]) : 'author:@guojufeng';
      }
      return resultArr;
    }
    var newArr2 = arr.gjfFilter(function (el, i, arr) {
      console.log(el, i, arr)
      console.log(this,el.b)
      return el.b > 20
    }, 'str');
    console.log(newArr2);
    newArr2[1].b = 'gjf';
    console.log('浅拷贝',arr, newArr2)
  </script>
</body>

</html>